<!DOCTYPE html>
<html lang="en">
<head>

<title>Melbourne CBD Tourism Analysis</title>

<!--

Template 2099 Scenic

http://www.tooplate.com/view/2099-scenic

-->

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/magnific-popup.css">

<link rel="stylesheet" href="css/owl.theme.css">
<link rel="stylesheet" href="css/owl.carousel.css">

<!-- MAIN CSS -->
<link rel="stylesheet" href="css/tooplate-style.css">

<!-- Mapbox dependencies-->

<script src='https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css' rel='stylesheet' />

</head>

<body>

    <div class="preloader">
        <div class="spinner">
             <span class="sk-inner-circle"></span>
        </div>
   </div>

    <!-- MENU -->
<div class="navbar custom-navbar navbar-fixed-top" role="navigation">
    <div class="container">
         <!-- NAVBAR HEADER -->
         <div class="navbar-header">
              <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                   <span class="icon icon-bar"></span>
                   <span class="icon icon-bar"></span>
                   <span class="icon icon-bar"></span>
              </button>
              <!-- lOGO -->
              <a href="index.html" class="navbar-brand">Melbourne CBD Tourism</a>
         </div>

         <!-- MENU LINKS -->
         <div class="collapse navbar-collapse">
              <ul class="nav navbar-nav navbar-right">
                   <li><a href="#home" class="smoothScroll">Home</a></li>
                   <li><a href="#about" class="smoothScroll">Tour Resources</a></li>
                   <li><a href="#team" class="smoothScroll">Stay & Fun</a></li>  
                   <li><a href="#contact" class="smoothScroll">Visitor Density</a></li>
              </ul>
         </div>

    </div>
</div>

<!-- HOME -->
<section id="home" class="parallax-section">
    <div class="overlay"></div>
    <div class="container">
         <div class="row">
              <div class="col-md-10 col-sm-12">
                   <div class="home-text">
                        <h1>Melbourne CBD circle tourism data visualization</h1>
                        <p>Stay Close, Go further - may digital tourism make your life better</p>
                        <ul class="section-btn">
                             <a href="#about" class="smoothScroll"><span data-hover="Discover More">Discover More</span></a>
                        </ul>
                   </div>
              </div>
         </div>
    </div>

    <!-- Video -->
    <video controls="" autoplay="" loop="" muted>
         <source src="videos/video.mp4" type="video/mp4">
         Your browser does not support the video tag.
    </video>
</section>

<section id="about" class="parallax-section">
    <div class="container-fluid">
         <div class="row">
              <div class="col-md-offset-1 col-md-10 col-sm-12">
                   <div class="about-info">
                        <h1>Tour Resources</h1>
                        <br>
                        <br>
                        <!-- mapbox cotent -->
                        <div class="container-fluid" id="mapbox-map">
                            <div class="row center">
                                <div class="col-12 col-sm-6 col-md-8" id="map">
                                    <nav id="menu"></nav>
                                    <!--Show legend -->
                                    <div class="map-overlay text-left" id="legend">Landmarks</div>
                                    <!--Show title -->
                                    <div class="map-overlay" id="title">
                                        <h2>Please click on the Tramstops or Hover on the Landmarks.</h2>
                                        <h2>You may find your place of interests.</h2>
                                    </div>
                                </div>
                                <div class="col-6 col-md-4" id='content'>
                                    <iframe
                                    id='street'
                                    class="container-fluid"
                                    width="465px"
                                    height="600px"
                                    frameborder="0" style="border:0"
                                    src="">
                                    </iframe>
                                </div>
                            </div>
                            <div class="text-left">
                                <br>
                                <p>
                                    The map shows Melbourne's landmarks, tram routes and stations. The menu bar is displayed at the top right of the map. You can choose one type of landmark according to your preference. When you click or hover landmark or tram stops with the mouse, the detailed information of the location will be displayed on the map. In addition, if you click the corresponding icon with the mouse, the right part of the map will switch to the street view near the location.
                                </p>
                            </div>
                        </div>

                        <script>
                            var myLat = "-37.8062917";
                            var myLan = "144.9594483";
                            mapboxgl.accessToken = 'pk.eyJ1IjoidmljdG9yNDIzIiwiYSI6ImNrdGs4N3ExajA3ZDAyb3A1NzdqYjl6bjkifQ.UZ5945aOIQJmC3mZaA6KyQ';
                                var map = new mapboxgl.Map({
                                container: 'map',
                                style: "mapbox://styles/victor423/ckup73oa305u418nxvwpvezp7/draft",
                                center: [144.965, -37.815],
                                zoom: 13.80
                            })
                            let streetView = document.getElementById("street");
                            let streetSrc = "https://www.google.com/maps/embed/v1/streetview?key=AIzaSyAmRpjggJlwIau3LgCxVIFdStRAxpk2EuA&&location="+myLat+","+myLan+"&heading=220&pitch=0&fov=80";
                            streetView.setAttribute('src', streetSrc);
                            function a(){
                                streetSrc = "https://www.google.com/maps/embed/v1/streetview?key=AIzaSyAmRpjggJlwIau3LgCxVIFdStRAxpk2EuA&&location="+myLat+","+myLan+"&heading=220&pitch=0&fov=80";
                                streetView.setAttribute('src', streetSrc);
                            }
                            map.on('load', () => {
                                const layers = [
                                    'Hospital',
                                    'Place of Assembly',
                                    'Place of Leisure',
                                    'Place of Worship',
                                    'Store/Carpark/Residential',
                                    'Transport',
                                    'Tramstops',
                                    'Others'
                                ];
                                const icons =[
                                    'Icon/Hosptial.png',
                                    'Icon/Assembly.png',
                                    'Icon/Leisure.png',
                                    'Icon/Worship.png',
                                    'Icon/Mixed.png',
                                    'Icon/Transport.png',
                                    'Icon/Tramstops.png',
                                    'Icon/Others.png'
                                ]
                                const legend = document.getElementById('legend');
                                //Refer to the code of lab5 .
                                layers.forEach((layer, i) => {
                                    const item = document.createElement('div');
                                    const key = document.createElement('span');
                                    key.className = 'legend-key';
                                    const value = document.createElement('span');
                                    const icon = document.createElement('img');
                                    icon.className = 'legend-key'
                                    icon.src = icons[i];
                                    key.appendChild(icon);
                                    value.innerHTML = `${layer}`;
                                    item.appendChild(key);
                                    item.appendChild(value);
                                    legend.appendChild(item);
                                });
                                var leableLayerIds = ['Hospital', 'Place of Assembly', 'Place of Leisure','Place of Worship', 'Store_Carpark_Residential', 'Transport', 'Others'];
                                for (var id of leableLayerIds){
                                    map.setLayoutProperty(id, 'visibility', 'none');
                                }
                                map.on(
                                    'click',
                                    (data) => {
                                        const temp = map.queryRenderedFeatures(data.point, {
                                            layers: ['Tramstops']
                                        }); 
                                        //console.log(temp)
                                        if (!temp.length) {
                                            return;
                                        }
                                        const info = temp[0];
                                        myLat = data.lngLat.lat+"";
                                        myLan = data.lngLat.lng+"";
                                        console.log(data.lngLat);
                                        console.log(myLat, myLan);
                                        a();
                                        const popup = new mapboxgl.Popup({ offset: [0, -15] }).setLngLat(data.lngLat)
                                            .setHTML(
                                            `<h4>Stop number: ${info.properties.mccid_int}</h4><h4>Stop name: ${info.properties.name} </h4>`
                                            )
                                            .addTo(map);
                                });
                            });
                            map.on('idle', () => {
                                // If these two layers were not added to the map, abort
                                if (!map.getLayer('Hospital') || !map.getLayer('Place of Assembly')) {
                                    return;
                                }
                                console.log('222');
                                var toggleableLayerIds = ['Hospital', 'Place of Assembly', 'Place of Leisure','Place of Worship', 'Store_Carpark_Residential', 'Transport', 'Tramstops', 'Others'];
                                // Set up the corresponding toggle button for each layer.
                                for (var id of toggleableLayerIds) {
                                    // Skip layers that already have a button set up.
                                    if (document.getElementById(id)) {
                                        continue;
                                    }

                                    // Create a link.
                                    var link = document.createElement('a');
                                    link.id = id;
                                    link.href = '#';
                                    link.textContent = id;
                                    link.className = '';
                                    // Show or hide layer when the toggle is clicked.
                                    link.onclick = function (e) {
                                        var clickedLayer = this.textContent;
                                        e.preventDefault();
                                        e.stopPropagation();

                                        var visibility = map.getLayoutProperty(
                                            clickedLayer,
                                            'visibility'
                                        );

                                        // Toggle layer visibility by changing the layout object's visibility property.
                                        if (visibility === 'visible') {
                                            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                                            this.className = '';
                                        } else {
                                            this.className = 'active';
                                            map.setLayoutProperty(
                                                clickedLayer,
                                                'visibility',
                                                'visible'
                                            );
                                            map.on(
                                                'click',
                                                (data) => {
                                                    const temp = map.queryRenderedFeatures(data.point, {
                                                        layers: [clickedLayer]
                                                    }); 
                                                    if (!temp.length) {
                                                        return;
                                                    }
                                                    myLat = data.lngLat.lat+"";
                                                    myLan = data.lngLat.lng+"";
                                                    console.log(data.lngLat);
                                                    console.log(myLat, myLan);
                                                    a();
                                            });
                                            const popup = new mapboxgl.Popup({
                                                closeButton: false,
                                                closeOnClick: false
                                            });
                                            map.on('mouseenter', clickedLayer, (e) => {
                                            map.getCanvas().style.cursor = 'pointer';
                                            console.log(e);
                                            point1 = e.lngLat;
                                            console.log(point1);
                                            const coordinates = e.features[0].geometry.coordinates.slice();
                                            const barsHover = 'Location theme: ' + e.features[0].properties['Sub Theme'] + ', Location name: ' + e.features[0].properties['Feature Name'];
                                        
                                            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                                                coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                                            }
                                            
                                            popup.setLngLat(coordinates).setHTML(barsHover).addTo(map);
                                            });
                                            
                                            map.on('mouseleave', clickedLayer, () => {
                                                map.getCanvas().style.cursor = '';
                                                popup.remove();
                                            });
                                        }};

                                    var layers = document.getElementById('menu');
                                    layers.appendChild(link);
                                }
                            });
                        </script>
<!-- mapbox cotent -->
                    </div>
              </div>
         </div>
    </div>
</section>

<section id="team" class="parallax-section">
    <div class="container-fluid">
         <div class="row">
             <div class="col-4">
                <!-- SECTION TITLE -->
                <div class="section-title">
                    <h1>Stay & Fun</h1>
                </div>
            </div> 
            <div class="row center">
                <div id="tableau1">
                    <div class='tableauPlaceholder' 
                    id='viz1634825117834' 
                    style='position: relative'>
                    <noscript>
                        <a href=' '>
                            <img alt='Entertainment ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Me&#47;Melbourneentertainment&#47;Entertainment&#47;1_rss.png' style='border: none' />
                        </a >
                    </noscript>
                    <object class='tableauViz'  style='display:none;'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                        <param name='embed_code_version' value='3' /> 
                        <param name='site_root' value='' />
                        <param name='name' value='Melbourneentertainment&#47;Entertainment' />
                        <param name='tabs' value='no' />
                        <param name='toolbar' value='yes' />
                        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Me&#47;Melbourneentertainment&#47;Entertainment&#47;1.png' /> 
                        <param name='animate_transition' value='yes' />
                        <param name='display_static_image' value='yes' />
                        <param name='display_spinner' value='yes' />
                        <param name='display_overlay' value='yes' />
                        <param name='display_count' value='yes' />
                        <param name='language' value='en-US' />
                        <param name='filter' value='publish=yes' />
                    </object>
                </div>                
                <script type='text/javascript'>                    
                var divElement = document.getElementById('viz1634825117834');                    
                var vizElement = divElement.getElementsByTagName('object')[0];                    
                if ( divElement.offsetWidth > 800 ) { vizElement.style.width='100%';vizElement.style.height='700px';} 
                else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='100%';vizElement.style.height='700px';} 
                else { vizElement.style.width='100%';vizElement.style.height='700px';}                     
                var scriptElement = document.createElement('script');                    
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
                vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                </script>
                <div class="text-left">
                    <br>
                    <p>The map shows Melbourne's landmarks, tram routes and stations. The menu bar is displayed at the top right of the map. You can choose one type of landmark according to your preference. When you click or hover landmark or tram stops with the mouse, the detailed information of the location will be displayed on the map. In addition, if you click the corresponding icon with the mouse, the right part of the map will switch to the street view near the location</p>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                </div>
                </div>
                
            </div>
        </div>
    </div>
</section>

<section id="contact" class="parallax-section">
    <div class="container-fluid">
         <div class="row">
             <div class="col-4">
                <!-- SECTION TITLE -->
                <div class="section-title">
                    <h1 style="color: #fff;">Visitor Density</h1>
                </div>
            </div>
            <div class="container-fluid" id="tableau2">
                <div class="col-12 col-sm-6 col-md-8">
                    <div class='tableauPlaceholder' id='viz1634659210366' style='position: relative'>
                        <noscript>
                            <a href=' '>
                                <img alt='仪表板 2' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Pe&#47;PedestriansVolumeCityMelbourne-v2&#47;2&#47;1_rss.png' style='border: none' />
                            </a>
                        </noscript>
                        <object class='tableauViz'  style='display:none;'>
                            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                            <param name='embed_code_version' value='3' />
                            <param name='site_root' value='' />
                            <param name='name' value='PedestriansVolumeCityMelbourne-v2&#47;2' />
                            <param name='tabs' value='no' />
                            <param name='toolbar' value='yes' />
                            <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Pe&#47;PedestriansVolumeCityMelbourne-v2&#47;2&#47;1.png' /> 
                            <param name='animate_transition' value='yes' />
                            <param name='display_static_image' value='yes' />
                            <param name='display_spinner' value='yes' />
                            <param name='display_overlay' value='yes' />
                            <param name='display_count' value='yes' />
                            <param name='language' value='en-US' />
                        </object>
                    </div>                
                    <script type='text/javascript'>                    
                    var divElement = document.getElementById('viz1634659210366');                    
                    var vizElement = divElement.getElementsByTagName('object')[0];                    
                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} 
                    else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} 
                    else { vizElement.style.width='100%';vizElement.style.height='1377px';}                     
                    var scriptElement = document.createElement('script');                    
                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                    </script>
                </div>
                <div class="col-6 col-md-4">
                    <div id="population-density">
                        <div id="pop-density-text">
                            <h2 class="text-center"><b>Melbourne Pedestrian Volume Heat Map</b></h2>
                            <p class="text-left">
                                Melbourne is a busy city with every year more than 400,000 walking trips made. The trends has shown that it might increse to 1,000,000 people by 2030.
                                
                                The map shows you the popular landmarkers of Melbourne, as well as its pedestrian volume. You may avoid crowd cases to relief your Covid-19 concerns or visit most popular city attractions based on those views. You may also click each plot to only see its charts. These map and charts shall help you make travel route decision.
                            </p>
                            <h2 class="text-center"><b>Hourly and Weekly Impacts</b></h2>
                            <p class="text-left">
                                Melbourne lunch time and rush hours are shown. Also, you may see that under impacts of Covid-19, the volume of pedestrians has been cut in half. The distribution of volume in working weekdays and weekends is also comparable in this charts.
                            </p>
                        </div>
                    </div>
                </div>
            </div>  
            <br>
            <br>
            <br> 
        </div>
    </div>
</section>

<footer>
    <div class="container">
         <div class="row">

              <div class="col-6 col-md-4">
                   <h4>
                       <b>Creators</b>
                       <br>Chan Xu
                       <br>Yiming Qi
                       <br>Tianliang Zhang
                       <br>Hai Yang
                   </h4>    
              </div>

              <div class="col-6 col-md-4">
                <h4>
                    <b>Contacts</b>
                    <br>chanx2@student.unimelb.edu.au
                    <br>weichengq@student.unimelb.edu.au
                    <br>tianliangz@student.unimelb.edu.au
                    <br>haiy@student.unimelb.edu.au
                </h4>    
              </div>

              <div class="col-6 col-md-4">         
                <h4>
                    <b>About</b>
                    <br>This data visualization web page is created for GEOM90007 subject of the University of Melbourne. If you have any inquiries related to the content, please feel free to contact us through Emails. 
                </h4>
              </div>
              <div class="clearfix"></div>
              <div class="col-md-12 col-sm-12">
                   <div class="copyright-text">
                        <h4>Copyright © 2021 Chan Xu, Yiming Qi, Tianliang Zhang, and Hai Yang
                        
                            | Web Design Inspiration: <a rel="nofollow" href="https://www.tooplate.com">Tooplate</a>
                        </h4>
                   </div>
              </div>
              
         </div>
    </div>
</footer>


<!-- SCRIPTS -->
<script src="js/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.parallax.js"></script>
<script src="js/owl.carousel.min.js"></script>
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/magnific-popup-options.js"></script>
<script src="js/modernizr.custom.js"></script>
<script src="js/smoothscroll.js"></script>
<script src="js/custom.js"></script>
</body>